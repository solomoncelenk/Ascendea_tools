<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contribution Income Calculator</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <button id="theme-toggle" class="btn-secondary no-print" style="position: fixed; top: 16px; right: 16px; z-index: 10;" aria-label="Toggle Dark/Light Theme">ðŸŒ“</button>

    <div class="container">
        <div class="input-panel">
            <h1>Contribution Income Calculator</h1>
            
            <div class="card">
                <h2>Basic Inputs</h2>
                
                <div class="form-group">
                    <label for="currency">Currency</label>
                    <select id="currency" class="currency-selector">
                        <option value="$">$ USD</option>
                        <option value="â‚¬">â‚¬ EUR</option>
                        <option value="Â£">Â£ GBP</option>
                        <option value="Â¥">Â¥ JPY</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="revenue">Revenue <span class="tooltip">?<span class="tooltip-text">Total income from sales before any expenses</span></span></label>
                    <input type="number" id="revenue" min="0" step="1000" placeholder="Enter revenue amount">
                </div>
            </div>
            
            <div class="card">
                <div class="form-group">
                    <h2>Variable Costs <span class="tooltip">?<span class="tooltip-text">Costs that change with production volume (e.g., materials, commissions)</span></span></h2>
                    <button id="add-cost-btn" class="btn-secondary btn-small no-print" aria-label="Add new variable cost item">+ Add Cost Item (A)</button>
                </div>
                
                <div class="variable-costs-list" id="variable-costs-container">
                    </div>
            </div>
            
            <div class="card">
                <h2>Advanced Options</h2>
                
                <div class="form-group">
                    <label class="form-row checkbox-label">
                        <input type="checkbox" id="show-gross-profit">
                        <span class="checkbox-custom"></span>
                        <span>Show Gross Profit (Includes COGS)</span>
                    </label>
                </div>
                
                <div id="gross-profit-section" class="hidden">
                    <div class="form-group">
                        <label for="cogs">Cost of Goods Sold (COGS)</label>
                        <input type="number" id="cogs" min="0" step="1000" placeholder="Enter COGS amount">
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-row checkbox-label">
                        <input type="checkbox" id="show-fixed-costs">
                        <span class="checkbox-custom"></span>
                        <span>Show Fixed Costs (To calculate Operating Profit)</span>
                    </label>
                </div>
                
                <div id="fixed-costs-section" class="hidden">
                    <div class="form-group">
                        <label for="fixed-costs">Fixed Costs</label>
                        <input type="number" id="fixed-costs" min="0" step="1000" placeholder="Enter fixed costs amount">
                    </div>
                </div>
            </div>
            
            <div class="card no-print">
                <h2>Scenario Tools</h2>
                
                <div class="form-group">
                    <label for="scenario-slider">Revenue Scenario (<span id="scenario-value">0%</span>)</label>
                    <input type="range" id="scenario-slider" min="-50" max="50" value="0" step="5">
                    <div class="form-row" style="justify-content: space-between; font-size: 0.875rem; color: var(--text-soft);">
                        <span>-50%</span>
                        <span>Base Revenue</span>
                        <span>+50%</span>
                    </div>
                </div>
                
                <div class="presets">
                    <h3 style="width: 100%; margin-bottom: 8px;">Presets:</h3>
                    <button class="preset-btn" data-preset="agency">Agency Retainer</button>
                    <button class="preset-btn" data-preset="d2c">DTC Order</button>
                    <button class="preset-btn" data-preset="saas">SaaS Subscription</button>
                </div>
                
                <div class="actions">
                    <button id="reset-btn" class="btn-secondary">Reset</button>
                    <button id="undo-btn" class="btn-secondary" disabled>Undo</button>
                    <button id="copy-btn" class="btn-secondary">Copy Snapshot</button>
                    <button id="csv-btn" class="btn-secondary">Download CSV</button>
                    <button id="print-btn" class="btn-secondary">Print</button>
                    <button id="info-btn" class="btn-secondary">About</button>
                </div>
            </div>
        </div>
        
        <div class="results-panel">
            <div class="card">
                <h2>Results</h2>
                
                <div class="kpi">
                    <div class="kpi-value" id="contribution-income">$0</div>
                    <div class="kpi-label">Contribution Income <span class="tooltip">?<span class="tooltip-text">Revenue minus variable costs - shows how much contributes to covering fixed costs and profit</span></span></div>
                </div>
                
                <div class="kpi">
                    <div class="kpi-value kpi-neutral" id="contribution-margin">0%</div>
                    <div class="kpi-label">Contribution Margin <span class="tooltip">?<span class="tooltip-text">Contribution Income as a percentage of Revenue - shows efficiency</span></span></div>
                </div>
                
                <hr style="border-top: 1px dashed var(--card-border); margin: 24px 0;">

                <div class="kpi">
                    <div class="kpi-value kpi-secondary" id="revenue-display">$0</div>
                    <div class="kpi-label">Revenue (Adjusted)</div>
                </div>
                
                <div class="kpi">
                    <div class="kpi-value kpi-secondary" id="variable-costs-display">$0</div>
                    <div class="kpi-label">Variable Costs (Adjusted)</div>
                </div>
                
                <div id="gross-profit-results" class="hidden">
                    <div class="kpi">
                        <div class="kpi-value kpi-secondary" id="gross-profit-display">$0</div>
                        <div class="kpi-label">Gross Profit</div>
                    </div>
                    
                    <div class="kpi">
                        <div class="kpi-value kpi-secondary" id="gross-margin-display">0%</div>
                        <div class="kpi-label">Gross Margin</div>
                    </div>
                </div>
                
                <div id="operating-profit-results" class="hidden">
                    <div class="kpi">
                        <div class="kpi-value kpi-secondary" id="operating-profit-display">$0</div>
                        <div class="kpi-label">Operating Profit</div>
                    </div>
                    
                    <div class="kpi">
                        <div class="kpi-value kpi-secondary" id="operating-margin-display">0%</div>
                        <div class="kpi-label">Operating Margin</div>
                    </div>
                </div>
            </div>
            
            <div class="card no-print">
                <h2>Webinar Tools</h2>
                
                <div class="form-group">
                    <label class="form-row">
                        <div class="toggle-switch">
                            <input type="checkbox" id="presenter-mode">
                            <span class="toggle-slider"></span>
                        </div>
                        <span>Presenter Mode (M)</span>
                    </label>
                </div>
                
                <div class="form-group">
                    <button id="help-btn" class="btn-secondary">Keyboard Shortcuts (?)</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="presenter-overlay" id="presenter-overlay">
        Last change: Initial load
    </div>
    
    <div class="modal" id="info-modal">
        <div class="modal-content">
            <button class="modal-close" id="info-modal-close" aria-label="Close">Ã—</button>
            <h2>About Contribution Income</h2>
            <div class="info-section">
                <h3>1. The Core Idea</h3>
                <p>Every sale brings in revenue. But not all of that revenue is yours to keep â€” first you have to pay for everything that changes with each sale: ad spend to acquire the customer, contractors or delivery labour, payment processing fees, shipping or fulfilment, and any other cost that rises as sales rise. Once those are paid, what's left is your contribution income.</p>
                
                <h3>2. The Simple Formula</h3>
                <p><strong>Contribution Income = Revenue âˆ’ Variable Costs</strong></p>
                <p>Example: You sell a service for $10,000. It costs $7,000 to deliver (ads, freelancers, commissions). â†’ Contribution Income = $3,000. That $3,000 goes toward paying your fixed costs â€” like full-time staff, office rent, and tools â€” and whatever remains after that becomes your net profit.</p>
                
                <h3>3. Why It Matters</h3>
                <p>It tells you how much each sale truly adds to the business, not just revenue on paper. It shows whether your offers are scalable â€” if your contribution income is thin, growing sales might not grow profit. It's the control metric for pricing, CAC, and margin discipline.</p>
                
                <h3>4. The Relationship to Contribution Margin (%)</h3>
                <p>Contribution Income is the actual number (the dollars left after variable costs). Contribution Margin is the percentage of each sale that becomes contribution income. Example: If you make $3,000 on a $10,000 sale, your contribution margin = 30%.</p>
                
                <h3>5. The Big Picture</h3>
                <p>Think of your business in layers: Revenue â€“ total money coming in. Variable Costs â€“ what you spend to make that money. Contribution Income â€“ what's left to cover fixed costs and profit. Fixed Costs â€“ salaries, rent, software. Net Profit â€“ what's left after everything.</p>
                <p><strong>In one line:</strong> Contribution income is the cash each sale contributes to running and growing your business â€” after delivery costs, before overheads.</p>
            </div>
            <div class="actions">
                <button id="close-info-btn" class="btn-primary">Got it!</button>
            </div>
        </div>
    </div>
    
    <div class="modal" id="help-modal">
        <div class="modal-content">
            <button class="modal-close" id="help-modal-close" aria-label="Close">Ã—</button>
            <h2>Keyboard Shortcuts</h2>
            <ul style="list-style: none; padding: 0; margin: 16px 0;">
                <li style="padding: 8px 0; border-bottom: 1px solid var(--card-border);"><strong>R</strong> - Focus Revenue field</li>
                <li style="padding: 8px 0; border-bottom: 1px solid var(--card-border);"><strong>A</strong> - Add new variable cost</li>
                <li style="padding: 8px 0; border-bottom: 1px solid var(--card-border);"><strong>D</strong> - Delete selected cost</li>
                <li style="padding: 8px 0; border-bottom: 1px solid var(--card-border);"><strong>M</strong> - Toggle Presenter Mode</li>
                <li style="padding: 8px 0; border-bottom: 1px solid var(--card-border);"><strong>?</strong> - Show this help</li>
                <li style="padding: 8px 0;"><strong>Esc</strong> - Close any open modal</li>
            </ul>
            <div class="actions">
                <button id="close-help-btn" class="btn-primary">Got it!</button>
            </div>
        </div>
    </div>

    <template id="cost-template">
        <div class="variable-cost-item">
            <label class="checkbox-label" tabindex="0" role="checkbox" aria-checked="true">
                <input type="checkbox" class="cost-included-checkbox" checked>
                <span class="checkbox-custom"></span>
            </label>
            <input type="text" value="New Cost" placeholder="Cost name" class="cost-name-input">
            <input type="number" value="0" min="0" step="100" class="cost-amount-input">
            <button class="btn-secondary btn-small delete-cost-btn" aria-label="Remove cost item">Ã—</button>
        </div>
    </template>
    
    <script src="script.js" type="module"></script>
</body>
</html>
